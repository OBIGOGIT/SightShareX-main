var pageChange=function(b,a){Log.d("pageChange() -> page : ",b," size: ",a);products.getSelectProductType(b)},companyTypes=function(){Log.d("companyTypes() called...");axios.post("/manage/company/types").then(function(b){b=b.data;var a=b.length;Log.d("companyTypes() -> data : ",b);for(var c="",d=0;d<a;d++)c+='<option value="%s">%s</option>'.sprintf(b[d].company_type_id,b[d].company_type_value);getID("selCompanyType").innerHTML+=c;"I"!=queryString("mode")&&companyDetailInfo()}).catch(function(b){Log.d("companyTypes() -> error=",
b)})},companyDetailInfo=function(){Log.d("companyDetailInfo() called...");var b=new URLSearchParams;b.append("companyId",queryString("companyId"));Log.d("params : ",b);axios.post("/manage/company/detail",b).then(function(a){a=a.data;Log.d("companyDetailInfo() -> data : ",a);0<a.length&&(getID("txtCompanyName").value=a[0].company_name,getID("selCompanyType").value=a[0].company_type_id,getID("txtDomain").value=a[0].domain,getID("txtEmail").value=a[0].email,getID("selActive").value=a[0].is_active,getID("txtDesc").value=
a[0].description,getID("txtCreateId").value=a[0].create_id,getID("txtUpdateId").value=a[0].update_id,getID("txtCreatedDate").value=utcToLoc(a[0].created),getID("txtUpdatedDate").value=utcToLoc(a[0].updated))}).catch(function(a){Log.d("companyDetailInfo() -> error=",a)})},products={datas:[],bChanged:!1,setUI:function(){for(var b=getID("select-products").innerHTML="",a="",c=0;c<products.datas.length;c++)a+=products.datas[c].select?"<td><label class='ob-customcheck'><input type='checkbox' onclick='products.changeSelect(%s, this)' style='display: none;' checked><span class='ob-checkmark'></span></label></td>".sprintf(products.datas[c].producttype):
"<td><label class='ob-customcheck'><input type='checkbox' onclick='products.changeSelect(%s, this)' style='display: none;'><span class='ob-checkmark'></span></label></td>".sprintf(products.datas[c].producttype),a+="<td>%s</td>".sprintf(products.datas[c].productname),a+="<td>%s</td>".sprintf(products.datas[c].description),a+="<td>%s</td>".sprintf(products.datas[c].useremail),a+="<td>%s</td>".sprintf(products.datas[c].updated),b+="<tr>%s</tr>".sprintf(a),a="";getID("select-products").innerHTML=b},changeSelect:function(b,
a){for(var c=0;c<this.datas.length;c++)if(this.datas[c].producttype==b){this.datas[c].select=a.checked;this.bChanged=!0;break}},setDatas:function(b){products.datas=[];var a=b.length;if(!(0>=a)){for(var c=0;c<a;c++)products.datas.push({select:!1,producttype:b[c].producttype,productname:b[c].productname,description:b[c].description,useremail:b[c].useremail,updated:utcToLoc(b[c].updated)});Log.d("products.makeSelectProducts() -> products.datas=",products.datas);this.setUI()}},getSelectedProductTypes:function(b){var a=
new URLSearchParams;a.append("companyId",b);Log.d("params : ",a);axios.post("/manage/company/producttype/selected",a).then(function(c){Log.d("/manage/company/producttype/selected -> response.data : ",c.data);c=c.data;var a=c.length;if(!(0>=c.length)){for(var b=0;b<products.datas.length;b++)for(var e=0;e<a;e++)products.datas[b].producttype==c[e].product_type&&(products.datas[b].select=!0);products.setUI()}}).catch(function(a){Log.d("products.getSelectedProductTypes() -> error=",a)})},getSelectProductType:function(b){var a=
new URLSearchParams;a.append("curPage",b);a.append("pageUnit",PAGE_UNIT);Log.d("params : ",a);axios.post("/manage/company/producttype/list",a).then(function(a){Log.d("/manage/company/producttype/list -> response.data : ",a.data);var b=a.data;0>=b.length||(products.setDatas(b),a=b[0].page,b=Math.ceil(b[0].totalcnt/PAGE_UNIT),Log.d("curPage : ",a),Log.d("pageCount : ",b),"undefined"!=typeof Pagination&&(Pagination._pageNum=b,Pagination._initPage=a,Pagination.Init(document.getElementById("pagination"),
{size:Pagination._pageNum,page:Pagination._initPage,step:3})),"I"!=queryString("mode")&&products.getSelectedProductTypes(queryString("companyId")))}).catch(function(a){Log.d("error=",a)})},updateSelectedProduct:function(b){Log.d("products.updateSelectedProduct() called...");var a=new URLSearchParams;a.append("companyId",b);a.append("curProductTypes",JSON.stringify(this.datas));Log.d("products.updateSelectedProduct() -> params : ",a);axios.post("/manage/company/producttype/selected/modify",a).then(function(a){Log.d("response.data : ",
a.data);"ok"==a.data.result&&(Log.d("\ucc98\ub9ac \uc131\uacf52"),mv("/manage/company/list.do"))}).catch(function(a){Log.d("products.updateSelectedProduct() -> error=",a)})}};window.addEventListener("DOMContentLoaded",function(){Log.d("companyDetail.js -> DOMContentLoaded() called...");companyTypes();products.getSelectProductType(1)});window.onload=function(b){Log.d("companyDetail.js -> window.onload called...",b)};
null!=getID("btnSave")&&(getID("btnSave").onclick=function(b){Log.d("companyDetail.js -> btnSave() called...");if(""==getVal("txtCompanyName"))modalAlert("Company name is required.");else if(""==getVal("selCompanyType"))modalAlert("Company type is required.");else if(""==getVal("txtDomain"))modalAlert("Domain is required.");else if(""==getVal("txtEmail"))modalAlert("Email is required.");else{b=new URLSearchParams;b.append("companyId",queryString("companyId"));b.append("companyName",getVal("txtCompanyName"));
b.append("companyType",getVal("selCompanyType"));b.append("domain",getVal("txtDomain"));b.append("email",getVal("txtEmail"));b.append("active",getVal("selActive"));b.append("description",getVal("txtDesc"));Log.d("btnSave() -> params : ",b);var a="";a="I"==queryString("mode")?"/manage/company/add":"/manage/company/modify";axios.post(a,b).then(function(a){Log.d("response.data : ",a.data);if("failed"==a.data.result)modalAlert("Processing failed.");else if("redirect"==a.data.result)mv(a.data.cmd);else{var b=
"";"I"==queryString("mode")&&(b=a.data.desc);0==products.bChanged?(Log.d("\ucc98\ub9ac \uc131\uacf51"),mv("/manage/company/list.do")):"I"==queryString("mode")?products.updateSelectedProduct(b):products.updateSelectedProduct(queryString("companyId"))}}).catch(function(a){Log.d("btnSave() -> error=",a)})}});getID("btnList").onclick=function(b){Log.d("companyDetail.js -> btnList() called...");mv("/manage/company/list.do")};
getID("selectAll").onchange=function(b){Log.d("selectAll() -> e.target.checked : ",b.target.checked);for(var a=0;a<products.datas.length;a++)products.datas[a].select=b.target.checked,products.bChanged=!0;products.setUI()};
