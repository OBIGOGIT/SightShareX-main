var COL_START=3,pageChange=function(b,a){Log.d("pageChange() -> page : ",b," size: ",a);historyList(b)},companies=function(){Log.d("companies() called...");axios.post("/common/company/clist").then(function(b){b=b.data;var a=b.length;Log.d("companies() -> data : ",b);for(var c="",e=0;e<a;e++)c+='<option value="%s">%s</option>'.sprintf(b[e].company_id,b[e].company_name);getID("selCompany").innerHTML+=c}).catch(function(b){Log.d("companies() -> error=",b)})},producttypesall=function(){Log.d("producttypesall() called...");
axios.post("/history/producttype/clist").then(function(b){b=b.data;var a=b.length;Log.d("producttypesall() -> data : ",b);for(var c="",e=0;e<a;e++)c+='<option value="%s">%s</option>'.sprintf(b[e].product_type,b[e].product_value);getID("selProductType").innerHTML+=c}).catch(function(b){Log.d("producttypesall() -> error=",b)})},historyList=function(b){getID("table-list-body").innerHTML="";var a=new URLSearchParams;switch(queryString("type")){case "1":a.append("action",getVal("txtAction"));null!=getID("selCompany")&&
a.append("company_id",getVal("selCompany"));a.append("name",getVal("txtName"));a.append("email",getVal("txtEmail"));a.append("ip_addr",getVal("txtIp"));a.append("detail",getVal("txtDetail"));break;case "2":a.append("action",getVal("txtAction"));a.append("email",getVal("txtEmail"));a.append("ip_addr",getVal("txtIp"));a.append("detail",getVal("txtDetail"));null!=getID("selProductType")&&a.append("product_type",getVal("selProductType"));a.append("product_name",getVal("txtProduct"));break;case "3":a.append("action",
getVal("txtAction"));a.append("email",getVal("txtEmail"));a.append("ip_addr",getVal("txtIp"));null!=getID("selProductType")&&a.append("product_type",getVal("selProductType"));a.append("product_name",getVal("txtProduct"));break;case "4":a.append("to",getVal("txtTo")),a.append("from",getVal("txtFrom")),a.append("content_type",getVal("txtContentType")),a.append("product_name",getVal("txtProduct"))}0<getVal("txtStart").length?a.append("start",locToUtc(getVal("txtStart")+" 00:00:00")):a.append("start",
"");0<getVal("txtEnd").length?a.append("end",locToUtc(getVal("txtEnd")+" 23:59:59")):a.append("end","");a.append("curPage",b);a.append("pageUnit",PAGE_UNIT);b="/history/user/list";switch(queryString("type")){case "1":b="/history/user/list";break;case "2":b="/history/system/list";break;case "3":b="/history/product/list";break;case "4":b="/history/email/list"}showHide("table-list",!1);scrollSave("my-scroll-pos");axios.post(b,a).then(function(a){Log.d("response.data : ",a.data);if(!(0>=a.data.length)){a=
a.data;getID("total-count").innerHTML=a[0].totalcnt;if(""==getID("table-list-head").innerHTML){for(var b=Object.getOwnPropertyNames(a[0]),d="",c=COL_START;c<b.length;c++)d=c==COL_START?d+'<th style="text-align: center;">%s</th>'.sprintf(b[c]):d+"<th>%s</th>".sprintf(b[c]);b="<tr>%s</tr>".sprintf(d);getID("table-list-head").innerHTML=b}d=b="";c=a.length;for(var g=0;g<c;g++){for(var h=Object.getOwnPropertyNames(a[0]),f=COL_START;f<h.length;f++)d=f==COL_START?d+'<td align="center">%s</td>'.sprintf(a[g][h[f]]):
f==h.length-1?d+"<td>%s</td>".sprintf(utcToLoc(a[g][h[f]])):d+"<td>%s</td>".sprintf(a[g][h[f]]);b+='<tr style="cursor: pointer;">%s</tr>'.sprintf(d);d=""}getID("table-list-body").innerHTML=b;b=a[0].page;a=Math.ceil(a[0].totalcnt/PAGE_UNIT);Log.d("curPage : ",b);Log.d("pageCount : ",a);"undefined"!=typeof Pagination&&(Pagination._pageNum=a,Pagination._initPage=b,Pagination.Init(document.getElementById("pagination"),{size:Pagination._pageNum,page:Pagination._initPage,step:3}));scrollRestore("my-scroll-pos");
showHide("table-list",!0)}}).catch(function(a){Log.d("qnaList() -> error : ",a)})};window.addEventListener("DOMContentLoaded",function(){Log.d("DOMContentLoaded() called...");historyList(1);switch(queryString("type")){case "1":companies();break;case "2":case "3":producttypesall()}});getID("btnSearch").onclick=function(b){Log.d("btnSearch() called...");historyList(1)};
