var PAGE_UNIT=5,COL_START=3,pageChange=function(a,b){Log.d("pageChange() -> page : ",a," size: ",b);customFieldList(a)},customFields=function(){Log.d("customFields() called...");getID("selCustomfield").innerHTML='<option value="">= Select Field =</option>';axios.post("/manage/producttype/extfield/selected/list").then(function(a){a=a.data;var b=a.length;Log.d("customFields() -> data : ",a);for(var c="",g=0;g<b;g++)c+='<option value="%s">%s</option>'.sprintf(a[g].ext_type,a[g].ext_value);getID("selCustomfield").innerHTML+=
c;"I"!=queryString("mode")&&productTypeDetail()}).catch(function(a){Log.d("customFields() -> error=",a)})},customFieldDetail=function(a){Log.d("customFieldDetail() -> ext_type=",a);var b=new URLSearchParams;b.append("ext_type",a);b.append("curPage","1");b.append("pageUnit",PAGE_UNIT);axios.post("/manage/producttype/extfield/list",b).then(function(c){Log.d("response.data : ",c.data);0>=c.data.length||(c=c.data,Log.d("customFieldDetail() -> result=",c),getID("hdnExtTypeU").value=a,getID("hdnCustomFieldU").value=
c[0]["Field Name"],getID("txtCustomFieldU").value=c[0]["Field Name"],getID("txtCustomFieldDescU").value=c[0].Description,customFieldValues(a),showHide("bgCustomFieldStatusU",!1))}).catch(function(a){Log.d(a)})},customFieldValues=function(a){Log.d("customFieldValues() -> ext_type=",a);getID("selAddedFieldValuesU").innerHTML="";var b=new URLSearchParams;b.append("ext_type",a);axios.post("/manage/producttype/extfield/detail",b).then(function(a){Log.d("response.data : ",a.data);if(!(0>=a.data.length)){a=
a.data;var c=a.length;Log.d("customFieldValues() -> result=",a);for(var b="",d=0;d<c;d++)b+='<option value="%s">%s</option>'.sprintf(a[d].col_value_id,a[d].col_value);getID("selAddedFieldValuesU").innerHTML=b}}).catch(function(a){Log.d(a)})},customFieldList=function(a){getID("table-list-body").innerHTML="";var b=new URLSearchParams;b.append("customFieldName",getVal("txtCustomFieldName"));b.append("description",getVal("txtCustomFieldDescForSearch"));b.append("curPage",a);b.append("pageUnit",PAGE_UNIT);
axios.post("/manage/producttype/extfield/list",b).then(function(a){Log.d("response.data : ",a.data);if(!(0>=a.data.length)){a=a.data;if(""==getID("table-list-head").innerHTML){for(var b=Object.getOwnPropertyNames(a[0]),c="",d=COL_START;d<b.length;d++)c+="<th>%s</th>".sprintf(b[d]);b="<tr>%s</tr>".sprintf(c);getID("table-list-head").innerHTML=b}c=b="";d=a.length;for(var e=0;e<d;e++){for(var h=Object.getOwnPropertyNames(a[0]),f=COL_START;f<h.length;f++)c=8==f?"1"==a[e][h[f]]?c+"<td>On</td>":c+"<td>Off</td>":
c+"<td>%s</td>".sprintf(a[e][h[f]]);b+='<tr style="cursor: pointer;" onclick="customFieldDetail(\'%s\')">%s</tr>'.sprintf(a[e].ext_type,c);c=""}getID("table-list-body").innerHTML=b;b=a[0].page;a=Math.ceil(a[0].totalcnt/PAGE_UNIT);Log.d("curPage : ",b);Log.d("pageCount : ",a);"undefined"!=typeof Pagination&&(Pagination._pageNum=a,Pagination._initPage=b,Pagination.Init(document.getElementById("pagination"),{size:Pagination._pageNum,page:Pagination._initPage,step:3}))}}).catch(function(a){Log.d(a)})},
productTypeDetail=function(){var a=queryString("producttype");Log.d("productTypeDetail() -> productType : ",a);var b=new URLSearchParams;b.append("productType",a);axios.post("/manage/producttype/detail",b).then(function(b){Log.d("response.data : ",b.data);0>=b.data.length||(b=b.data,getID("hdnProductType").value=a,getID("txtProductValue").value=b[0].product_value,getID("hdnProductValue").value=b[0].product_value,getID("txtDesc").value=b[0].description,getID("txtUserEmail").value=b[0].user_email,getID("txtUpdated").value=
utcToLoc(b[0].updated),getExts(a))}).catch(function(a){Log.d("productTypeDetail() -> error : ",a)})},getExts=function(a){Log.d("getExts() -> productType : ",a);var b=new URLSearchParams;b.append("productType",a);axios.post("/manage/producttype/extfield/flist",b).then(function(a){Log.d("getExts() -> response.data : ",a.data);if(!(0>=a.data.length)){a=a.data;for(var b=a.length,c="",d=0;d<b;d++)c+='<option value="%s">%s</option>'.sprintf(a[d].extType,a[d].extValue);getID("selSelectedFieldValue").innerHTML=
c}}).catch(function(a){Log.d("getExts() -> error : ",a)})};window.addEventListener("DOMContentLoaded",function(){Log.d("DOMContentLoaded() called...");customFields();customFieldList(1)});getID("btnSearch").onclick=function(a){Log.d("btnSearch() called...");customFieldList(1)};
getID("btnCheckDupProduct").onclick=function(a){Log.d("btnCheckDupProduct() called...");var b=getVal("txtProductValue");""==b?(showHide("bgProductNameStatus",!1),modalAlert("Product type name is required.")):"I"!=queryString("mode")&&getVal("hdnProductValue")==b?showHide("bgProductNameStatus",!0):axios.post("/manage/producttype/duplicate").then(function(a){a=a.data;for(var c in a)if(a[c].product_value==b){"I"!=queryString("mode")?getID("txtProductValue").value=getVal("hdnProductValue"):getID("txtProductValue").value=
"";showHide("bgProductNameStatus",!1);modalAlert(b+" is already registered.");return}showHide("bgProductNameStatus",!0)}).catch(function(a){Log.d("btnCheckDupProduct() -> error=",a)})};
getID("btnAddCustomField").onclick=function(a){Log.d("btnAddCustomField() -> e : ",a);a=getID("selCustomfield").value;var b=getSelectedText("selCustomfield");3<=selectCount("selSelectedFieldValue")?modalAlert("Up to 3 user-defined columns are allowed."):isSelectTxt("selSelectedFieldValue",b)?modalAlert("This column is already added."):(a='<option value="%s">%s</option>'.sprintf(a,b),getID("selSelectedFieldValue").innerHTML+=a)};
getID("btnRemoveCustomField").onclick=function(a){Log.d("btnRemoveCustomField() -> e : ",a);rmSelectedOpts("selSelectedFieldValue")};
getID("btnCheckDupFieldU").onclick=function(a){var b=getVal("txtCustomFieldU");getVal("hdnCustomFieldU")==b?(Log.d("btnCheckDupFieldU() \uc911\ubcf5\uccb4\ud06c \ud544\uc694 \uc5c6\uc74c."),showHide("bgCustomFieldStatusU",!0)):""==b?(showHide("bgCustomFieldStatusU",!1),modalAlert("The user-defined column is blank.")):axios.post("/manage/producttype/extfield/selected/list").then(function(a){a=a.data;for(var c in a)if(a[c].ext_value==b){modalAlert(b+" is already registered.");getID("txtCustomFieldU").value=
getID("hdnCustomFieldU").value;showHide("bgCustomFieldStatusU",!1);return}showHide("bgCustomFieldStatusU",!0)}).catch(function(a){Log.d("btnCheckDupField() -> error=",a)})};
getID("btnCheckDupField").onclick=function(a){var b=getVal("txtCustomField");""==b?(showHide("bgCustomFieldStatus",!1),modalAlert("The user-defined column is blank.")):axios.post("/manage/producttype/extfield/selected/list").then(function(a){a=a.data;for(var c in a)if(a[c].ext_value==b){modalAlert(b+" is already registered.");getID("txtCustomField").value="";showHide("bgCustomFieldStatus",!1);return}showHide("bgCustomFieldStatus",!0)}).catch(function(a){Log.d("btnCheckDupField() -> error=",a)})};
getID("btnAddFieldItemU").onclick=function(a){Log.d("btnAddFieldItemU()");a=getID("txtFieldValueU").value;isSelectTxt("selAddedFieldValuesU",a)?modalAlert("User-defined column value is already registered."):(a='<option value="">%s</option>'.sprintf(a),getID("selAddedFieldValuesU").innerHTML+=a)};getID("btnRemoveFieldItemU").onclick=function(a){Log.d("btnRemoveFieldItemU()");rmSelectedOpts("selAddedFieldValuesU")};
getID("btnAddFieldItem").onclick=function(a){Log.d("btnAddFieldItem()");a=getID("txtFieldValue").value;isSelectTxt("selAddedFieldValues",a)?modalAlert("User-defined column value is already registered."):(a='<option value="%s">%s</option>'.sprintf(a,a),getID("selAddedFieldValues").innerHTML+=a)};getID("btnRemoveFieldItem").onclick=function(a){Log.d("btnRemoveFieldItem()");rmSelectedOpts("selAddedFieldValues")};
null!=getID("btnUpdateCustomField")&&(getID("btnUpdateCustomField").onclick=function(a){Log.d("btnUpdateCustomField()");""==getVal("hdnCustomFieldU")?modalAlert("It can be modified after selection."):"none"==getID("bgCustomFieldStatusU").style.display?modalAlert("A duplicate check is required."):(Log.d("\uc81c\uc57d \uc870\uac74 \ud1b5\uacfc..."),a=new URLSearchParams,a.append("extType",getVal("hdnExtTypeU")),a.append("customField",getVal("txtCustomFieldU")),a.append("description",getVal("txtCustomFieldDescU")),
a.append("fieldValues",JSON.stringify(selectToArray("selAddedFieldValuesU"))),Log.d("params : ",a),axios.post("/manage/producttype/extfield/selected/modify",a).then(function(a){Log.d("response.data : ",a.data);"ok"==a.data.result?(customFields(),showHide("bgCustomFieldStatusU",!1),Log.d("Processing success."),location.reload()):modalAlert("Processing failed.")}).catch(function(a){Log.d("btnUpdateCustomField() -> error=",a)}))});
null!=getID("btnInsertCustomField")&&(getID("btnInsertCustomField").onclick=function(a){Log.d("btnInsertCustomField()");a=new URLSearchParams;a.append("customField",getVal("txtCustomField"));a.append("description",getVal("txtCustomFieldDesc"));a.append("fieldValues",JSON.stringify(selectToArray("selAddedFieldValues")));Log.d("params : ",a);axios.post("/manage/producttype/extfield/selected/add",a).then(function(a){Log.d("response.data : ",a.data);"ok"==a.data.result?(customFields(),Log.d("Processing success."),
location.reload()):modalAlert("Processing failed.")}).catch(function(a){Log.d("btnInsertCustomField() -> error=",a)})});
null!=getID("btnSaveProduct")&&(getID("btnSaveProduct").onclick=function(a){Log.d("btnSaveProduct() -> e:",a);if("none"==getID("bgProductNameStatus").style.display)modalAlert("A duplicate check is required.");else{a=new URLSearchParams;var b="";"I"==queryString("mode")?b="/manage/producttype/add":(b="/manage/producttype/modify",a.append("productType",getVal("hdnProductType")));a.append("productValue",getVal("txtProductValue"));a.append("description",getVal("txtDesc"));a.append("fieldValues",JSON.stringify(selectToArray("selSelectedFieldValue")));
axios.post(b,a).then(function(a){Log.d("response.data : ",a.data);"ok"==a.data.result?(Log.d(b+" : \ucc98\ub9ac \uc131\uacf5"),mv("/manage/producttype/list.do")):modalAlert("Processing failed.")}).catch(function(a){Log.d("btnSaveProduct() -> error=",a)})}});
if(null!=getID("btnDeleteProduct")&&"I"!=queryString("mode")){var deleteProduct=function(){var a=new URLSearchParams;a.append("productType",getVal("hdnProductType"));axios.post("/manage/producttype/delete",a).then(function(a){Log.d("response.data : ",a.data);"ok"==a.data.result?(Log.d("\ucc98\ub9ac \uc131\uacf5"),mv("/manage/producttype/list.do")):modalAlert("Processing failed.")}).catch(function(a){Log.d("btnDeleteProduct() -> error=",a)})};getID("btnDeleteProduct").onclick=function(a){Log.d("btnDeleteProduct() -> e:",
a);bootbox.confirm({title:"Confirmation",message:"Do you really want to delete this item ?",buttons:{confirm:{label:"Yes",className:"btn-primary"},cancel:{label:"No",className:"btn-primary"}},callback:function(a){Log.d("callback -> r:"+a);a&&deleteProduct()}})}}getID("btnList").onclick=function(a){mv("/manage/producttype/list.do")};getID("selAddedFieldValuesU").onclick=function(a){getID("txtFieldValueU").value=a.target.innerText};
getID("btnModifyFieldItemU").onclick=function(a){a=getVal("txtFieldValueU");Log.d("btnModifyFieldItemU() -> modifyData : ",a);setSelectItem("selAddedFieldValuesU",a)};getID("txtProductValue").onkeyup=function(a){showHide("bgProductNameStatus",!1)};
